# Установка Postgres
Развернем самую популярную, на текущий момент, базу данных Postgres.
Мы не будем устанавливать её прямо на нашу операционку Windows или Mac в моем случае, а воспользуемся замечательным докером.
## Установка Docker Desktop
Сначала, нам нужно скачать и установить [Docker Desktop](https://www.docker.com/products/docker-desktop/)</br>
Докер - это такое средство контейнеризации, который развернет нам такую маленькую, облегчённую linux с установленной внутри неё базой данных Postgres.

## Развертывание Docker-контейнера Postgres
Теперь приступим к развертыванию докер-контейнера Postgres

### Создаем файл docker-compose.yml
Создаем в папке файл [docker-compose.yml](./../docker-compose.yml). В этом файле мы можем определять любые контейнеры

Мы определим здесь 2 докер контейнера:
1. с базой postgres
2. и еще один контейнер с клиентом pgAdmin - он нам нужен, чтобы делать запросы в нашу бд

Вверху файла указываем версию docker compose
`version: '3.8'`

затем в блоке `services` описываем наши контейнеры:

давайте опишем контейнер `postgres`
нам нужен docker образ, который мы можем найти на `Docker Hub`, здесь также есть инструкция для docker-compose

```yaml
version: '3.8'

services:
   postgres:
      container_name: postgres_container
      image: postgres
      environment:
         POSTGRES_USER: postgres
         POSTGRES_PASSWORD: postgres
         PGDATA: /var/lib/postgresql/data
      ports:
         - "5432:5432"
      restart: unless-stopped
```
`container_name` - имя контейнера может быть любым, какое нам нравится
`image` - это сам докер образ, который представляет из себя linux с предустановленной внутри нее postgres. Здесь используется стандартный образ postgres из `Docker Hub`
`environment` - список переменных окружения, которые будут установлены в контейнере
   `POSTGRES_USER` - имя пользователя 
   `POSTGRES_PASSWORD` - пароль пользователя
   `PGDATA` - важная переменная, которая указывает путь внутри контейнера, где PostgreSQL должен хранить данные в таблицах
`ports` - настраивает перенаправление портов с хост-машины(нашего компьютера) на контейнер. Это означает что из нашего компьютера в контейнер мы сможем пролезть по порту `5432`,
а из контейнера в базу данных по порту `5432`. Снаружи, контейнер будет доступен по порту `5432`, а внутри контейнера база данных будет крутиться на порту `5432`
`restart` - политика перезапуска контейнера. Мы укажем `unless-stopped`, так контейнер будет всегда перезапускаться, в случае остановки из-за непредвиденных ошибок, за исключением случаев, когда он был явно остановлен пользователем.

теперь опишем контейнер `pgadmin`
он нам нужен для того чтобы мы могли администрировать и делать запросы в нашу базу данных через удобный web интерфейс

```yaml
  pgadmin:
    container_name: pgadmin_container
    image: dpage/pgadmin4
    environment:
      PGADMIN_DEFAULT_EMAIL: oit@gmail.com
      PGADMIN_DEFAULT_PASSWORD: admin
    ports:
      - "5050:80"
    restart: unless-stopped
```
используем стандартный dpage/pgadmin4 
зададим необходимые переменные и укажем порт для контейнера и для pgadmin

### Запуск контейнеров
Теперь, когда у нас создан файл [docker-compose.yml](./../docker-compose.yml) давайте запустим все докер-контейнеры, которые мы определили в нем

для этого выполним команду запуска</br>
`docker-compose up -d`

проверим результат,</br>
`docker-compose ps`

тот же самый результат можем увидеть в Docker Decktop